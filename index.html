<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è‚²æˆãƒãƒ©ãƒ³ã‚¹é…ç½®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>

<style>
:root{
  --bg:#fff7f0;
  --card:#ffffff;
  --accent:#f2b5b5;
  --accent2:#b5d8f2;
  --border:#e0cfc2;
  --owned:#f2b5b5;
  --unowned:#cccccc;
}

body{
  font-family: "Hiragino Maru Gothic ProN","Yu Gothic",sans-serif;
  background: var(--bg);
  margin:0;
  padding:20px;
  color:#4a3b2a;
}

h1{
  text-align:center;
  margin-bottom:30px;
}

h2{
  margin-top:40px;
  border-left:6px solid var(--accent);
  padding-left:10px;
}

.card{
  background:var(--card);
  border-radius:16px;
  box-shadow:0 6px 12px rgba(0,0,0,0.15);
  padding:16px;
  margin-bottom:20px;
}

.char-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:16px;
}

.char-card{
  border:2px solid var(--border);
  border-radius:14px;
  padding:12px;
  background:#fffdf9;
  display:flex;
  gap:10px;
  align-items:flex-start;
}

.char-card.off{
  opacity:0.4;
  filter:grayscale(40%);
}

.char-img{
  max-width:70px;
  max-height:90px;
  object-fit:contain;
  border-radius:10px;
  border:1px solid var(--border);
  flex-shrink:0;
}

.char-info{ flex:1; }

.char-name{
  font-weight:bold;
  font-size:18px;
}

.skills{
  font-size:14px;
  margin:6px 0;
}

.owned-btn{
  margin-top:6px;
}

.owned-btn button{
  border:none;
  border-radius:14px;
  padding:4px 10px;
  font-size:12px;
  cursor:pointer;
}

.owned-true{
  background:var(--owned);
}

.owned-false{
  background:var(--unowned);
}

.lv{
  margin-top:8px;
  font-size:14px;
}

.lv input{
  width:50px;
  text-align:center;
}

.lv-btns button{
  background:var(--accent2);
  border:none;
  border-radius:8px;
  padding:4px 6px;
  margin:2px;
  font-size:12px;
  cursor:pointer;
}

.facility{ margin-bottom:8px; }

.result-card{
  background:#fff;
  border-radius:14px;
  padding:10px;
  margin-bottom:10px;
  box-shadow:0 4px 8px rgba(0,0,0,0.12);
}
</style>
</head>

<body>

<h1>ğŸŒ¸ è‚²æˆãƒãƒ©ãƒ³ã‚¹é…ç½®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ ğŸŒ¸</h1>

<h2>â‘  çŸ¥å·±ä¸€è¦§</h2>
<div class="card">
  <div class="char-grid" id="charArea"></div>
</div>

<h2>â‘¡ æ–½è¨­ä¸€è¦§</h2>
<div class="card" id="facilityArea"></div>

<h2>â‘¢ é…ç½®çµæœï¼ˆè‡ªå‹•æ›´æ–°ï¼‰</h2>
<div class="card" id="result"></div>

<script>
const facilities = [
 ["æœ±é›€å¤§é€šã‚Š","çµµç”»","å‰£","ç´"],
 ["èƒ¡å§«é…’å ´","å°†æ£‹","é¦¬","ç”Ÿã‘èŠ±"],
 ["å½±çµµèŠå±…å°å±‹","é…’","é¦¬","æ›¸é“"],
 ["è¯æ¸…æ± ","é…’","æ­¦","å°†æ£‹"],
 ["éŠèŠ¸é¤¨","è©©æ­Œ","å°„","é…’"],
 ["æåœ’","è©©æ­Œ","å°„","æ›¸é“"],
 ["é›å¡”åºƒå ´","çµµç”»","æ­¦","ç”Ÿã‘èŠ±"],
 ["å¤§æ…ˆæ©å¯º","ç´","å‰£","èŒ¶"]
];

const characters = [
  ["æ—å©‰å…",["çµµç”»","å‰£","ç´"],82],
  ["ã‚¯ãƒ¬ã‚ªãƒ‘ãƒˆãƒ©",["çµµç”»","æ­¦","ç”Ÿã‘èŠ±"],70],
  ["ç‘¤å§«",["çµµç”»","æ­¦","ç”Ÿã‘èŠ±"],69],
  ["ãƒ ãƒ¼ãƒ©ãƒ³",["çµµç”»","å‰£","ç´"],57],
  ["ã‚¨ã‚«ãƒãƒ¥ãƒªãƒ¼ãƒŠ",["ç´","å‰£","èŒ¶"],77],
  ["ä¸Šå®˜å©‰å…",["ç´","å‰£","é…’"],65],
  ["è²‚è‰",["ç´","é¦¬","èŒ¶"],53],
  ["ãŠå¸‚",["é…’","é¦¬","ç´™"],92],
  ["é«˜æ¼¸é›¢",["é…’","å‰£","çµµç”»"],51],
  ["è¶™é£›ç‡•",["è©©æ­Œ","å°„","é…’"],90],
  ["è‘‰è»½çœ‰",["è©©æ­Œ","å°„","æ›¸é“"],3],
  ["ææ¸…ç…§",["è©©æ­Œ","å°„","æ›¸é“"],79],
  ["æå¸«å¸«",["è©©æ­Œ","å°„","æ›¸é“"],3],
  ["è¥¿æ–½",["è©©æ­Œ","é¦¬","æ›¸é“"],61],
  ["å¦²å·±",["å°†æ£‹","å‰£","ç´"],68],
  ["ç²¾è¡›",["å°†æ£‹","å°„","ç”Ÿã‘èŠ±"],76],
  ["ã‚¸ãƒ£ãƒ³ãƒŒãƒ»ãƒ€ãƒ«ã‚¯",["å°†æ£‹","é¦¬","ç”Ÿã‘èŠ±"],62],
  ["é˜ç„¡è‰¶",["èŒ¶","æ­¦","æ›¸é“"],91],
  ["éˆ•ç¥œç¦„æ°",["èŒ¶","æ­¦","çµµç”»"],40],
  ["ãƒ´ã‚£ã‚¯ãƒˆãƒªã‚¢",["èŒ¶","æ­¦","å°†æ£‹"],3],
  ["æŸ³å¦‚æ˜¯",["é…’","é¦¬","ç”Ÿã‘èŠ±"],0],
  ["åŒ—æ¡æ”¿å­",["çµµç”»","å‰£","ç´"],0],
  ["æ¥Šç‰ç’°",["èŒ¶","æ­¦","å°†æ£‹"],0],
  ["ã‚¨ãƒªã‚¶ãƒ™ã‚¹",["è©©æ­Œ","å°„","é…’"],0],
  ["å«¦å¨¥",["çµµç”»","å‰£","ç´"],0],
  ["ãƒŸãƒ¼ãƒ¦ã‚¨",["å°†æ£‹","é¦¬","ç”Ÿã‘èŠ±"],0]
];

const state=[];
const charArea=document.getElementById("charArea");

function renderCharacters(){
  charArea.innerHTML="";
  state.length=0;

  characters.forEach((c,index)=>{
    const obj={
      name:c[0],
      skills:c[1],
      lv:c[2],
      owned:c[2]>0
    };
    state.push(obj);

    const d=document.createElement("div");
    d.className="char-card"+(obj.owned?"":" off");

    d.innerHTML=`
      <img class="char-img"
        src="img/${obj.name}.jpg"
        onerror="this.onerror=null;this.src='img/${obj.name}.png'">

      <div class="char-info">
        <div class="char-name">${obj.name}</div>

        <div class="owned-btn">
          <button class="${obj.owned?'owned-true':'owned-false'}"
            onclick="toggleOwned(${index})">
            ${obj.owned?'ä¿æœ‰':'æœªä¿æœ‰'}
          </button>
        </div>

        <div class="skills">ğŸ¨ ${obj.skills.join("ãƒ»")}</div>

        <div class="lv">
          Lv
          <input type="number" value="${obj.lv}" readonly ${obj.owned?"":"disabled"}>
          <div class="lv-btns">
            <button onclick="changeLv(${index},10)">+10</button>
            <button onclick="changeLv(${index},1)">+1</button>
            <button onclick="changeLv(${index},-1)">-1</button>
            <button onclick="changeLv(${index},-10)">-10</button>
          </div>
        </div>
      </div>
    `;
    charArea.appendChild(d);
  });
}

function toggleOwned(index){
  const c=state[index];
  c.owned=!c.owned;

  const card=charArea.children[index];
  card.classList.toggle("off",!c.owned);

  const btn=card.querySelector(".owned-btn button");
  btn.textContent=c.owned?"ä¿æœ‰":"æœªä¿æœ‰";
  btn.className=c.owned?"owned-true":"owned-false";

  card.querySelectorAll(".lv input,.lv button")
    .forEach(el=>el.disabled=!c.owned);

  run();
}

function changeLv(index,delta){
  const c=state[index];
  if(!c.owned) return;
  c.lv=Math.max(0,c.lv+delta);
  charArea.children[index].querySelector(".lv input").value=c.lv;
  run();
}

const facilityArea=document.getElementById("facilityArea");
facilities.forEach(f=>{
  const d=document.createElement("div");
  d.className="facility";
  d.textContent=`${f[0]}ï¼š${f[1]}ãƒ»${f[2]}ãƒ»${f[3]}`;
  facilityArea.appendChild(d);
});

function run(){
  const result=document.getElementById("result");
  result.innerHTML="";
  const used=new Set();

  facilities.forEach(f=>{
    const req=f.slice(1);
    const ranked=state
      .filter(c=>c.owned && c.lv>0 && !used.has(c.name))
      .map(c=>({c,match:req.filter(r=>c.skills.includes(r)).length}))
      .sort((a,b)=>b.match-a.match||b.c.lv-a.c.lv);

    if(ranked[0]) used.add(ranked[0].c.name);
    if(ranked[1]) used.add(ranked[1].c.name);

    const div=document.createElement("div");
    div.className="result-card";
    div.innerHTML=`
      <strong>${f[0]}</strong><br>
      ğŸ® åº—é•·ï¼š${ranked[0]?.c.name||"â€”"}<br>
      ğŸŒ¿ å‰¯åº—é•·ï¼š${ranked[1]?.c.name||"â€”"}<br>
      ğŸ“œ è£œæ¬ ï¼š${ranked[2]?.c.name||"â€”"}
    `;
    result.appendChild(div);
  });
}

renderCharacters();
run();
</script>

</body>
</html>
